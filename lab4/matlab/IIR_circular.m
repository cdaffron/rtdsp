sampling_freq = 48000;
signal_freq = 16000;
N = 32;

num = [
 0.000000034667186407017829
 0                          
-0.00000055467498251228526   
 0                            
 0.0000041600623688421397      
 0                              
-0.000019413624387929986         
 0                                
 0.000063094279260772455           
 0                                  
-0.00015142627022585387              
 0                                   
 0.00027761482874739875              
 0                                   
-0.00039659261249628392              
 0                                   
 0.00044616668905831937              
 0                                   
-0.00039659261249628392              
 0                                   
 0.00027761482874739875              
 0                                   
-0.00015142627022585387              
 0                                   
 0.000063094279260772455             
 0                                   
-0.000019413624387929986             
 0                                   
 0.0000041600623688421397            
 0                                   
-0.00000055467498251228526           
 0                                   
 0.000000034667186407017829          
];

denom = [
   1            
  -1.9801853890905561
   9.1649400704466846 
 -14.888835049793361   
  39.091650150313797    
 -54.053519038133658     
 103.7940178244709        
-124.78218130144654        
 192.54424577919335         
-203.86713917280235          
 264.81870122989505           
-248.81759164235612            
 279.2832130917119              
-233.71194760902372              
 230.21109514072145               
-171.64616409746702                
 149.72630338342509                 
 -99.189355655056573                 
  76.98095076610899                  
 -45.023608184758089                 
  31.129471108367586                 
 -15.897784481372415                 
   9.7752574545111433                
  -4.2821998764558771                
   2.3303846019656183                
  -0.85057993413808886               
   0.40625646626076067               
  -0.11746136096242073               
   0.048599889346246553              
  -0.010070168757280885              
   0.0035386230275000646             
  -0.00040345651517289648            
   0.00011677740101310004            
];

time = (0:1/sampling_freq:0.05)';

audio_in = sin(2 * pi * signal_freq * time );
audio_out = zeros(size(audio_in));

working_data_in = zeros(N+1,1);
working_data_out = zeros(N+1,1);

sampleInd = 1;
indLeft = 1;

for j=1:length(audio_in)
    working_data_in(sampleInd)=audio_in(j);
    temp = 0.0;
    
    temp = temp + (num(1)*working_data_in(sampleInd));
    indLeft = sampleInd - 1;
    if( indLeft < 1)
        indLeft = N + 1;
    end
    
    for i=2:N+1
       temp = temp + (num(i)*working_data_in(indLeft)) - (denom(i)*working_data_out(indLeft));
       indLeft = indLeft - 1;
       if( indLeft < 1)
           indLeft = N + 1;
       end
    end
    
    working_data_out(sampleInd) = temp;
    
    sampleInd = sampleInd + 1;
    if( sampleInd > (N+1))
        sampleInd = 1;
    end
    
    audio_out(j) = temp;
end

plot(audio_in);
axis([0 2400 -1 1]);
title('Original Signal');
figure();
plot(audio_out);
axis([0 2400 -1 1]);
title('Filtered Signal');